From 4189ed22714506c1e827dda8dabf519e2705e8aa Mon Sep 17 00:00:00 2001
From: Ingmar Vanhassel <ingmar@exherbo.org>
Date: Sun, 21 Jun 2009 03:07:22 +0200
Subject: [PATCH 1/3] Build a shared libuu, Debian #216593

Extracted from http://patch-tracking.debian.net/package/uudeview/0.5.20-3.1
---
 uulib/Makefile.in |   18 +++++++++++++++---
 1 files changed, 15 insertions(+), 3 deletions(-)

diff --git a/uulib/Makefile.in b/uulib/Makefile.in
index 951c731..e351f73 100644
--- a/uulib/Makefile.in
+++ b/uulib/Makefile.in
@@ -21,9 +21,16 @@ SHELL	=	/bin/sh
 #
 CC	=	@CC@
 #
+# Library options
+SOMAJOR =	0
+SOMINOR =	$(PATCH)
+SHLIB =		libuu.so.$(SOMAJOR).$(SOMINOR)
+SHLIBSOMAJ =	libuu.so.$(SOMAJOR)
+SHLIBSO =	libuu.so
+#
 # C Compiler Options
 #
-CFLAGS	=	@CFLAGS@ -I. @CPPFLAGS@ @DEFS@
+CFLAGS	=	@CFLAGS@ -I. @CPPFLAGS@ @DEFS@ -fpic -shared
 #
 # the ranlib program
 #
@@ -51,11 +58,11 @@ UULIB_OBJ	=	${UULIB_SOURCE:.c=.o}
 .SUFFIXES:
 .SUFFIXES: .c .o
 
-all:		libuu.a
+all:		$(SHLIB)
 
 clean:
 	rm -f [Xx]deview gif2gfp
-	rm -f *.o *.a *.so core *~ TAGS
+	rm -f *.o *.a *.so $(SHLIBSOMAJ) $(SHLIB) core *~ TAGS
 
 distclean:	clean
 	rm -f config.status config.cache config.log Makefile config.h
@@ -67,6 +74,11 @@ new:		clean
 	rm -f libuu.a
 	$(MAKE) all
 
+$(SHLIB): $(UULIB_OBJ)
+	$(CC) -o $@ -fpic -shared -Wl,-soname,$(SHLIBSOMAJ) $^
+	ln -sf $(SHLIB) $(SHLIBSOMAJ)
+	ln -sf $(SHLIBSOMAJ) $(SHLIBSO)
+
 libuu.a:	$(UULIB_OBJ)
 	rm -f $@
 	ar r $@ $(UULIB_OBJ)
-- 
1.6.3.2

