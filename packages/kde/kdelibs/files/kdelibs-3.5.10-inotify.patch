From 309de8f244e166bc1ba024d998d5258ebd43628e Mon Sep 17 00:00:00 2001
From: Wulf C. Krueger <philantrop@exherbo.org>
Date: Mon, 16 Mar 2009 19:56:26 +0100
Subject: [PATCH] Use sys/inotify.h instead of linux/inotify.h which is broken since 2.6.27.

---
 kio/kio/kdirwatch.cpp |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/kio/kio/kdirwatch.cpp b/kio/kio/kdirwatch.cpp
index b85bf0a..1786bff 100644
--- a/kio/kio/kdirwatch.cpp
+++ b/kio/kio/kdirwatch.cpp
@@ -71,7 +71,7 @@
 #include <linux/types.h>
 // Linux kernel headers are documented to not compile
 #define _S390_BITOPS_H
-#include <linux/inotify.h>
+#include <sys/inotify.h>
 
 static inline int inotify_init (void)
 {
-- 
1.6.2

From 291b4591dc1f90e10fc10486d682f5b29df3be57 Mon Sep 17 00:00:00 2001
From: Wulf C. Krueger <philantrop@exherbo.org>
Date: Mon, 16 Mar 2009 21:02:17 +0100
Subject: [PATCH] Use sys/inotify.h instead of linux/inotify.h which allows for building with kernel headers >= 2.6.27.

Another option would have been to use http://patchwork.ozlabs.org/patch/316/
but considering that patching kernel headers for KDE seems strange enough,
upstream is opposed to that, too.
---
 kio/kio/kdirwatch.cpp |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/kio/kio/kdirwatch.cpp b/kio/kio/kdirwatch.cpp
index 1786bff..cbb3438 100644
--- a/kio/kio/kdirwatch.cpp
+++ b/kio/kio/kdirwatch.cpp
@@ -73,17 +73,17 @@
 #define _S390_BITOPS_H
 #include <sys/inotify.h>
 
-static inline int inotify_init (void)
+extern inline int inotify_init (void)
 {
   return syscall (__NR_inotify_init);
 }
 
-static inline int inotify_add_watch (int fd, const char *name, __u32 mask)
+extern inline int inotify_add_watch (int fd, const char *name, __u32 mask)
 {
   return syscall (__NR_inotify_add_watch, fd, name, mask);
 }
 
-static inline int inotify_rm_watch (int fd, __u32 wd)
+extern inline int inotify_rm_watch (int fd, __u32 wd)
 {
   return syscall (__NR_inotify_rm_watch, fd, wd);
 }
-- 
1.6.2

