Source: Bo Ã˜rsted Andresen
Upstream: No.
Reason: Fix automagic dependencies.

From 7f50b37813673ac9a155b54cdd94b3652c589b8d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Bo=20=C3=98rsted=20Andresen?= <zlin@exherbo.org>
Date: Tue, 24 Aug 2010 10:46:17 +0000
Subject: [PATCH] Crude fix for automagic dependencies.

---
 kexi/kexidb/drivers/CMakeLists.txt      |   25 ++++++++++++-------------
 kexi/migration/CMakeLists.txt           |   15 ++++++++-------
 krita/plugins/extensions/CMakeLists.txt |   12 ++++++------
 3 files changed, 26 insertions(+), 26 deletions(-)

diff --git a/kexi/kexidb/drivers/CMakeLists.txt b/kexi/kexidb/drivers/CMakeLists.txt
index dbd9ec3..b32172c 100644
--- a/kexi/kexidb/drivers/CMakeLists.txt
+++ b/kexi/kexidb/drivers/CMakeLists.txt
@@ -6,30 +6,29 @@ IF (SQLITE_FOUND)
   add_subdirectory( sqlite )
 ENDIF (SQLITE_FOUND)
 
-INCLUDE (FindMySQL)
+macro_optional_find_package(MySQL)
 IF (MYSQL_FOUND)
    add_subdirectory( mySQL )
 ENDIF (MYSQL_FOUND)
 
 
-INCLUDE (FindPostgreSQL)
-
 set (PQXX_MIN_VERSION "3.0.0")
 set (PQXX_MAX_VERSION "4.0.0")
 
 macro_optional_find_package(PostgreSQL)
-pkg_check_modules (PQXX libpqxx)
-
-IF (POSTGRESQL_FOUND AND PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
-   add_subdirectory( pqxx )
-ENDIF (POSTGRESQL_FOUND AND PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
-
-INCLUDE(FindFreeTDS)
-IF (FreeTDS_FOUND)
+IF (POSTGRESQL_FOUND)
+   pkg_check_modules (PQXX libpqxx)
+   IF (PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
+      add_subdirectory( pqxx )
+   ENDIF (PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
+ENDIF (POSTGRESQL_FOUND)
+
+macro_optional_find_package(FreeTDS)
+IF (FREETDS_FOUND)
    add_subdirectory(sybase)
-ENDIF (FreeTDS_FOUND)
+ENDIF (FREETDS_FOUND)
 
-INCLUDE(FindXBase)
+macro_optional_find_package(XBase)
 IF(XBASE_FOUND)
    add_subdirectory(xbase)
 ENDIF(XBASE_FOUND)
diff --git a/kexi/migration/CMakeLists.txt b/kexi/migration/CMakeLists.txt
index 37d4025..818c3af 100644
--- a/kexi/migration/CMakeLists.txt
+++ b/kexi/migration/CMakeLists.txt
@@ -24,13 +24,14 @@ set (PQXX_MAX_VERSION "4.0.0")
 
 macro_optional_find_package(PostgreSQL)
 macro_log_feature(POSTGRESQL_FOUND "libpq" "C application programmer's interface to PostgreSQL" "http://www.postgresql.org" FALSE "" "Required by Kexi PostgreSQL Migration driver")
-
-pkg_check_modules (PQXX libpqxx)
-macro_log_feature(PQXX_FOUND "libpqxx" "Official C++ client API for PostgreSQL" "http://pqxx.org/development/libpqxx/" FALSE "" "Required by Kexi PostgreSQL Migration driver")
-
-IF (POSTGRESQL_FOUND AND PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
-macro_optional_add_subdirectory( pqxx )
-ENDIF (POSTGRESQL_FOUND AND PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
+IF (POSTGRESQL_FOUND)
+   pkg_check_modules (PQXX libpqxx)
+   macro_log_feature(PQXX_FOUND "libpqxx" "Official C++ client API for PostgreSQL" "http://pqxx.org/development/libpqxx/" FALSE "" "Required by Kexi PostgreSQL Migration driver")
+
+   IF (PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
+   macro_optional_add_subdirectory( pqxx )
+   ENDIF (PQXX_FOUND AND PQXX_VERSION VERSION_GREATER PQXX_MIN_VERSION AND PQXX_VERSION VERSION_LESS PQXX_MAX_VERSION)
+ENDIF (POSTGRESQL_FOUND)
 
 macro_optional_find_package(FreeTDS)
 macro_log_feature(FREETDS_FOUND "FreeTDS" "Open source implementation of the TDS (Tabular Data Stream) protocol" "http://www.freetds.org" FALSE "" "Required by Kexi Sybase Migration driver")
diff --git a/krita/plugins/extensions/CMakeLists.txt b/krita/plugins/extensions/CMakeLists.txt
index 7ef2c34..8149aaf 100644
--- a/krita/plugins/extensions/CMakeLists.txt
+++ b/krita/plugins/extensions/CMakeLists.txt
@@ -24,13 +24,13 @@ if(OPENEXR_FOUND)
 #  add_subdirectory( painterlyframework )
 endif(OPENEXR_FOUND)
 
-find_package(OpenShiva)
-find_package(QtShiva )
+macro_optional_find_package(OpenShiva)
+macro_optional_find_package(QtShiva )
 
-if(HAVE_OPENSHIVA AND HAVE_QTSHIVA)
+if(OPENSHIVA_FOUND AND QTSHIVA_FOUND)
  add_subdirectory(shiva)
-endif(HAVE_OPENSHIVA AND HAVE_QTSHIVA)
+endif(OPENSHIVA_FOUND AND QTSHIVA_FOUND)
 
-macro_log_feature(HAVE_OPENSHIVA "OpenShiva" "OpenShiva interpreter for the Shiva Kernel Language" "http://www.openshiva.org" FALSE "" "Required for Shiva based Generators and Filters")
-macro_log_feature(HAVE_QTSHIVA "QtShiva" "Qt bindings for the OpenShiva interpreter" "http://www.openshiva.org" FALSE "" "Required for Shiva based Generators and Filters")
+macro_log_feature(OPENSHIVA_FOUND "OpenShiva" "OpenShiva interpreter for the Shiva Kernel Language" "http://www.openshiva.org" FALSE "" "Required for Shiva based Generators and Filters")
+macro_log_feature(QTSHIVA_FOUND "QtShiva" "Qt bindings for the OpenShiva interpreter" "http://www.openshiva.org" FALSE "" "Required for Shiva based Generators and Filters")
 
-- 
1.7.2.2

